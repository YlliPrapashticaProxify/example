var x=Object.create;var O=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var T=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var v=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of E(t))!S.call(e,c)&&c!==i&&O(e,c,{get:()=>t[c],enumerable:!(s=A(t,c))||s.enumerable});return e};var F=(e,t,i)=>(i=e!=null?x(K(e)):{},v(t||!e||!e.__esModule?O(i,"default",{value:e,enumerable:!0}):i,e));var w=T((z,P)=>{P.exports=y;y.flatten=y;y.unflatten=C;function R(e){return e&&e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function h(e){return e}function y(e,t){t=t||{};let i=t.delimiter||".",s=t.maxDepth,c=t.transformKey||h,g={};function j(f,b,l){l=l||1,Object.keys(f).forEach(function(r){let n=f[r],o=t.safe&&Array.isArray(n),u=Object.prototype.toString.call(n),a=R(n),m=u==="[object Object]"||u==="[object Array]",p=b?b+i+c(r):c(r);if(!o&&!a&&m&&Object.keys(n).length&&(!t.maxDepth||l<s))return j(n,p,l+1);g[p]=n})}return j(e),g}function C(e,t){t=t||{};let i=t.delimiter||".",s=t.overwrite||!1,c=t.transformKey||h,g={};if(R(e)||Object.prototype.toString.call(e)!=="[object Object]")return e;function f(r){let n=Number(r);return isNaN(n)||r.indexOf(".")!==-1||t.object?r:n}function b(r,n,o){return Object.keys(o).reduce(function(u,a){return u[r+i+a]=o[a],u},n)}function l(r){let n=Object.prototype.toString.call(r),o=n==="[object Array]",u=n==="[object Object]";if(r){if(o)return!r.length;if(u)return!Object.keys(r).length}else return!0}return e=Object.keys(e).reduce(function(r,n){let o=Object.prototype.toString.call(e[n]);return!(o==="[object Object]"||o==="[object Array]")||l(e[n])?(r[n]=e[n],r):b(n,r,y(e[n],t))},{}),Object.keys(e).forEach(function(r){let n=r.split(i).map(c),o=f(n.shift()),u=f(n[0]),a=g;for(;u!==void 0;){if(o==="__proto__")return;let m=Object.prototype.toString.call(a[o]),p=m==="[object Object]"||m==="[object Array]";if(!s&&!p&&typeof a[o]<"u")return;(s&&!p||!s&&a[o]==null)&&(a[o]=typeof u=="number"&&!t.object?[]:{}),a=a[o],n.length>0&&(o=f(n.shift()),u=f(n[0]))}a[o]=C(e[r],t)}),g}});var d=F(w(),1);async function I(e){let t=[];for(let i of e.config.languages){let s=e.pluginConfig.pathPattern.replace("{language}",i),c=(0,d.default)(JSON.parse(await e.$fs.readFile(s,"utf-8")));t.push(M(c,i))}return t}async function $(e){for(let t of e.resources){let i=e.pluginConfig.pathPattern.replace("{language}",t.languageTag.name);await e.$fs.writeFile(i,_(t))}}function M(e,t){return{type:"Resource",languageTag:{type:"LanguageTag",name:t},body:Object.entries(e).map(([i,s])=>N(i,s))}}function N(e,t){return{type:"Message",id:{type:"Identifier",name:e},pattern:{type:"Pattern",elements:[{type:"Text",value:t}]}}}function _(e){let t=Object.fromEntries(e.body.map(B));return JSON.stringify(d.default.unflatten(t),null,2)}function B(e){return[e.id.name,e.pattern.elements[0].value]}export{I as readResources,$ as writeResources};
